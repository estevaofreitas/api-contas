services:
  
  keycloak:
    image: quay.io/keycloak/keycloak:16.1.0
    ports:
      - "8090:8080"
    environment:
      - KEYCLOAK_USER=keycloak
      - KEYCLOAK_PASSWORD=keycloak
      - DB_DATABASE=keycloak
      - DB_ADDR=postgres.db
      - DB_USER=user
      - DB_PASSWORD=secret
      - DB_VENDOR=postgres
      - KEYCLOAK_IMPORT=/tmp/realm-export.json
    volumes:
      - ./realm-export.json:/tmp/realm-export.json
    depends_on:
      - postgres

  postgres:
    image: 'postgres:latest'
    environment:
      - 'POSTGRES_DB=contas'
      - 'POSTGRES_USER=user'
      - 'POSTGRES_PASSWORD=secret'
    ports:
      - '5432:5432'
    extra_hosts:
      - "postgres.db:host-gateway"